<div class="card">
    <app-dynamic-table [columns]="columns" [data]="users" [loading]="isLoading" [headerTitle]="'CHARGES LIST'"
        [rowActions]="actions" (onAction)="handleAction($event)">
    </app-dynamic-table>
</div>


<p-sidebar [(visible)]="showForm" position="right" [modal]="true"
    styleClass="!w-full sm:!w-[500px] lg:!w-[700px] !max-w-[90vw]">

    <div (click)="$event.stopPropagation()" class="flex flex-col h-full bg-white">

        <!-- Header -->
        <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white z-10">
            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                <i class="pi pi-plus-circle text-green-600 text-xl"></i>
                {{ header }}
            </h2>
        </div>

        <!-- Form -->
        <form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex-1 px-4 py-4 space-y-5 overflow-y-auto">

            <!-- Charge Name -->
            <div>
                <label for="charge_name" class="flex items-center gap-2 mb-1 text-sm font-medium text-gray-700">
                    <i class="pi pi-tag text-violet-500"></i>
                    Charge Name<span class="text-red-500">*</span>
                </label>
                <input id="charge_name" pInputText type="text" formControlName="charge_name"
                    placeholder="Enter charge name"
                    class="w-full border border-indigo-200 rounded-md focus:border-indigo-500 focus:ring-indigo-500 text-uppercase uppercase" />
                <span *ngIf="form.get('charge_name')?.touched && form.get('charge_name')?.errors?.['required']"
                    class="text-sm text-red-600">
                    Charge Name is required.
                </span>
            </div>

            <!-- Row: Tally Name & Taxable -->
            <div class="flex flex-col sm:flex-row gap-4">
                <!-- Tally Name -->
                <div class="flex-1">
                    <label for="TallyName" class="flex items-center gap-2 mb-1 text-sm font-medium text-gray-700">
                        <i class="pi pi-file-edit text-teal-500"></i>
                        Tally Name<span class="text-red-500">*</span>
                    </label>
                    <input id="TallyName" pInputText type="text" formControlName="TallyName"
                        placeholder="Enter tally name"
                        class="w-full border border-indigo-200 rounded-md focus:border-indigo-500 focus:ring-indigo-500 text-uppercase uppercase" />
                    <span *ngIf="form.get('TallyName')?.touched && form.get('TallyName')?.errors?.['required']"
                    class="text-sm text-red-600">
                    Tally Name is required.
                    </span>
                </div>

                <!-- Taxable -->
                <div class="flex-1">
                    <label for="taxable" class="flex items-center gap-2 mb-1 text-sm font-medium text-gray-700">
                        <i class="pi pi-percentage text-red-700"></i>
                        Taxable<span class="text-red-500">*</span>
                    </label>
                    <p-dropdown inputId="taxable" [options]="taxableOptions" [appendTo]="'body'"
                        formControlName="taxable" optionLabel="label" optionValue="value" placeholder="SELECT TAXABLE"
                        class="w-full border border-indigo-200 rounded-md focus:border-indigo-500 focus:ring-indigo-500">
                    </p-dropdown>
                    <span *ngIf="form.get('taxable')?.touched && form.get('taxable')?.errors?.['required']"
                    class="text-sm text-red-600">
                    Taxable is required.
                    </span>
                </div>
            </div>

        </form>

        <!-- Footer Buttons -->
        <div class="flex justify-end gap-2 p-4 border-t border-gray-200 sticky bottom-0 bg-white">
            <button pButton type="button" label="Cancel" icon="pi pi-times" class="p-button-text"
                (click)="showForm = false"></button>
            <button pButton type="submit" label="Save" icon="pi pi-save" [disabled]="form.invalid"
                (click)="onSubmit()"></button>
        </div>

    </div>
</p-sidebar>