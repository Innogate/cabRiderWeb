<!-- Show only after duties are added -->
<!-- *ngIf="mainDutyList.length > 0" -->
<div
  class="p-6 mt-8 bg-white border rounded-2xl space-y-8  mx-auto">
  <!-- ğŸŸ¡ Table Section -->
  <div
    class="p-4 rounded-xl bg-gradient-to-br from-sky-50 via-sky-50 to-blue-50 mt-6 border">
    <p-table [value]="mainDutyList" [paginator]="true" [rows]="10"
      [responsiveLayout]="'scroll'"
      [resizableColumns]="true" [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      class="p-datatable-gridlines rounded-xl">
      <ng-template pTemplate="header">
        <tr class="bg-blue-500 text-gray-800 text-sm font-semibold">
          <th class="py-3 px-4">
            <i class="pi pi-sort-numeric-up text-blue-500 mr-1"></i> SI No.
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-id-card text-green-600 mr-1"></i> Slip No.
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-briefcase text-purple-600 mr-1"></i> Duty Type
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-car text-orange-500 mr-1"></i> Car No.
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-cog text-gray-700 mr-1"></i> Car Type
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-building text-pink-600 mr-1"></i> Project
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-user text-indigo-600 mr-1"></i> Guest Name
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-calendar text-teal-600 mr-1"></i> From Date
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-calendar-times text-red-600 mr-1"></i> To Date
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-clock text-yellow-600 mr-1"></i> From Time
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-clock text-yellow-700 mr-1"></i> To Time
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-directions text-blue-700 mr-1"></i> From KM
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-directions-alt text-blue-800 mr-1"></i> To KM
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-stopwatch text-lime-600 mr-1"></i> Total Time
          </th>
          <th class="py-3 px-4">
            <i class="pi pi-compass text-cyan-600 mr-1"></i> Total KM
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-duty>
        <tr class="hover:bg-blue-50 transition-all text-sm">
          <td class="py-2 px-3">{{ duty.BookingNo }}</td>
          <td class="py-2 px-3">{{ duty.SlipNo }}</td>
          <td class="py-2 px-3">{{ duty.DutyTypeName }}</td>
          <td class="py-2 px-3">{{ duty.CarNo }}</td>
          <td class="py-2 px-3">{{ duty.CarType }}</td>
          <td class="py-2 px-3">{{ duty.Project }}</td>
          <td class="py-2 px-3">{{ duty.BookedBy }}</td>
          <td class="py-2 px-3">{{ duty.fromDate }}</td>
          <td class="py-2 px-3">{{ duty.toDate }}</td>
          <td class="py-2 px-3">{{ duty.GarageOutTime }}</td>
          <td class="py-2 px-3">{{ duty.GarageInDate | date:'HH:mm' }}</td>
          <td class="py-2 px-3">{{ duty.GarageOutKm }}</td>
          <td class="py-2 px-3">{{ duty.GarageInKm }}</td>
          <td class="py-2 px-3">{{ duty.TotalHour }}</td>
          <td class="py-2 px-3">{{ duty.TotalKm }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- ğŸ’  Billing Section -->
  <div
    class="col-span-full w-full p-4 sm:p-6 lg:p-8 border rounded-3xl bg-gradient-to-br from-sky-50 via-sky-50 to-blue-50 space-y-6 sm:space-y-8 lg:space-y-10">

    <!-- ğŸ”˜ Top Action -->
    <div
      class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">

      <!-- ğŸ“Š Totals -->
      <div
        class="flex flex-wrap items-center gap-4 bg-white/70 backdrop-blur-md px-4 py-2 rounded-xl shadow-sm border border-sky-100">
        <span class="text-blue-950 font-semibold text-base sm:text-lg">
          Total KM: <span class="text-gray-900">{{ showTotalKm }}</span>
        </span>
        <span class="text-blue-950 font-semibold text-base sm:text-lg">
          Total Hours: <span class="text-gray-900">{{ showTotalHour }}</span>
        </span>
      </div>

      <!-- ğŸ“Œ Calculate Button -->
      <button pButton label="Calculate Bill" icon="pi pi-calculator"
        (click)="calculateBillAndLog()"
        class="p-button p-button-lg p-button-primary rounded-xl shadow-md hover:scale-105 transition-transform w-full sm:w-auto">
      </button>
    </div>

    <!-- ğŸ§¾ Billing Summary Grid -->
    <div
      class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 p-2 sm:p-4">

      <!-- Column 1 -->
      <div class="space-y-3 sm:space-y-4">
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’° Fixed Amount:</label>
          <input type="number" pInputText [(ngModel)]="fixedAmount"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ•“ Extra Hours:</label>
          <input type="number" pInputText [(ngModel)]="extraHours"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸš— Extra K.M:</label>
          <input type="number" pInputText [(ngModel)]="extrakm"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ“‰ Except Day Hrs:</label>
          <input type="number" pInputText [(ngModel)]="exceptDayHrs"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸš Extra Day K.M:</label>
          <input type="number" pInputText [(ngModel)]="extraDaykm"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">â›½ Fuel Amount:</label>
          <input type="number" pInputText [(ngModel)]="fuelAmount"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <!-- <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">Sgst:</label>
          <input type="number" pInputText [(ngModel)]="Sgst"
            (ngModelChange)="calculateSGST()"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div> -->
      </div>

      <!-- Column 2 -->
      <div class="space-y-3 sm:space-y-4">
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ“† No. of Days:</label>
          <input type="number" pInputText [(ngModel)]="numDays"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" readonly />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’µ Rate:</label>
          <input type="number" pInputText [(ngModel)]="rate1"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’´ Rate:</label>
          <input type="number" pInputText [(ngModel)]="rate2"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’µ Rate:</label>
          <input type="number" pInputText [(ngModel)]="rate3"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’µ Rate:</label>
          <input type="number" pInputText [(ngModel)]="rate4"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ“± Mobile Amount:</label>
          <input type="number" pInputText [(ngModel)]="mobileAmount"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <!-- <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">Cgst:</label>
          <input type="number" pInputText [(ngModel)]="Cgst"
            (ngModelChange)="calculateCGST()"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div> -->
      </div>

      <!-- Column 3 -->
      <div class="space-y-3 sm:space-y-4">
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’³ Amount:</label>
          <input type="number" pInputText [(ngModel)]="Amount"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" readonly />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’³ Amount:</label>
          <input type="number" pInputText [(ngModel)]="extaHAmount"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-semibold text-green-600">ğŸ’³ Amount:</label>
          <input type="number" pInputText [(ngModel)]="billTotal2"
            class="w-full sm:w-40 lg:w-44 text-right font-bold text-green-700 mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’³ Amount:</label>
          <input type="number" pInputText [(ngModel)]="amount3"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-semibold text-gray-800">ğŸ’³ Amount:</label>
          <input type="number" pInputText [(ngModel)]="amount2"
            class="w-full sm:w-40 lg:w-44 text-right font-bold mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ“ Description:</label>
          <input type="text" pInputText [(ngModel)]="desc2"
            class="w-full sm:w-40 lg:w-44 text-right font-bold mt-1 sm:mt-0" />
        </div>
        <!-- <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">Igst:</label>
          <input type="number" pInputText [(ngModel)]="igst"
            (ngModelChange)="calculateIGST()"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div> -->
      </div>

      <!-- Column 4 -->
      <div class="space-y-3 sm:space-y-4">
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-semibold text-green-600">ğŸ§¾ Bill Total:</label>
          <input type="number" pInputText [(ngModel)]="billTotal"
            class="w-full sm:w-40 lg:w-44 text-right font-bold text-green-700 mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-medium text-gray-700">ğŸ’¸ Other
            Charges(Taxable):</label>
          <input type="number" pInputText [(ngModel)]="advance"
            class="w-full sm:w-40 lg:w-44 text-right mt-1 sm:mt-0" />
        </div>
        <!-- SGST -->
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2">
          <label class="font-medium text-gray-700">SGST:</label>
          <div class="flex items-center gap-1 w-full sm:w-auto">
            <input type="number" pInputText [(ngModel)]="Sgst"
              (ngModelChange)="calculateSGST()"
              class="w-full sm:w-20 lg:w-24 text-right border rounded px-2 py-1" />
            <span>%</span>
            <input type="number" pInputText 
              class="w-full sm:w-28 lg:w-32 text-right border rounded px-2 py-1" />
          </div>
        </div>

        <!-- CGST -->
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2">
          <label class="font-medium text-gray-700">CGST:</label>
          <div class="flex items-center gap-1 w-full sm:w-auto">
            <input type="number" pInputText [(ngModel)]="Cgst"
              (ngModelChange)="calculateCGST()"
              class="w-full sm:w-20 lg:w-24 text-right border rounded px-2 py-1" />
            <span>%</span>
            <input type="number" pInputText 
              class="w-full sm:w-28 lg:w-32 text-right border rounded px-2 py-1" />
          </div>
        </div>

        <!-- IGST -->
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2">
          <label class="font-medium text-gray-700">IGST:</label>
          <div class="flex items-center gap-1 w-full sm:w-auto">
            <input type="number" pInputText [(ngModel)]="igst"
              (ngModelChange)="calculateIGST()"
              class="w-full sm:w-20 lg:w-24 text-right border rounded px-2 py-1" />
            <span>%</span>
            <input type="number" pInputText 
              class="w-full sm:w-28 lg:w-32 text-right border rounded px-2 py-1" />
          </div>
        </div>

        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-bold text-gray-800">ğŸ’¸ Other Charges(Non
            Taxable)</label>
          <input type="number" pInputText
            class="w-full sm:w-40 lg:w-44 text-right font-semibold mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-semibold text-green-600">ğŸ§¾ Round Off:</label>
          <input type="number" pInputText [(ngModel)]="roundOff"
            class="w-full sm:w-40 lg:w-44 text-right font-bold text-green-700 mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-semibold text-green-600">ğŸ§¾ Advance(less):</label>
          <input type="number" pInputText [(ngModel)]="aboveAdvance"
            class="w-full sm:w-40 lg:w-44 text-right font-bold text-green-700 mt-1 sm:mt-0" />
        </div>
        <div
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
          <label class="font-bold text-gray-800">ğŸ’³ Net Payable:</label>
          <input type="number" pInputText [(ngModel)]="totalPaybleAmaunt"
            class="w-full sm:w-40 lg:w-44 text-right font-semibold mt-1 sm:mt-0" />
        </div>
      </div>

    </div>
  </div>

  <div
    class="col-span-full w-full p-8 border rounded-3xl bg-gradient-to-br from-sky-50 via-sky-50 to-blue-50 space-y-10">
    <div class=" bg-white rounded-2xl border border-blue-300 p-4">
      <h3
        class="text-lg font-bold text-blue-700 mb-4 flex items-center gap-2">
        <i class="pi pi-dollar text-yellow-500"></i>
        Other Charges
      </h3>

      <p-table
        [value]="charges"
        [responsiveLayout]="'scroll'"
        class="p-datatable-sm rounded-lg">
        <ng-template pTemplate="header">
          <tr class="bg-blue-100 text-blue-800 text-lg">
            <th>SINo <span class="text-red-500">*</span></th>
            <th>Other Charges <span class="text-red-500">*</span></th>
            <th>Amount <span class="text-red-500">*</span></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-row let-i="rowIndex">
          <tr class="hover:bg-blue-50">
            <td>{{ i + 1 }}</td>
            <td>{{ row.name }}</td>
            <td>â‚¹{{ row.amount }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>